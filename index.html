<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Tres en Raya ‚Ä¢ Janiito</title>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>
<style>
:root{--bg:#fdfcf9;--card:#ffffff;--text:#3d3d3d;--border:#f0ede5;--cell:#f7f6f2}[data-theme="dark"]{--bg:#141414;--card:#1c1c1c;--text:#e2e2e2;--border:#2a2a2a;--cell:#222222}body{font-family:'Inter',sans-serif;background-color:var(--bg);color:var(--text);display:flex;align-items:center;justify-content:center;min-height:100vh;margin:0;transition:0.4s}.container{background:var(--card);padding:2.5rem;border-radius:40px;width:400px;box-shadow:0 10px 40px rgba(0,0,0,0.03);border:1px solid var(--border);text-align:center;position:relative}h2{font-weight:200;letter-spacing:5px;text-transform:uppercase;font-size:0.9rem;margin-bottom:2rem;opacity:0.7}.block{background:var(--cell);padding:20px;border-radius:28px;margin-bottom:15px;border:1px solid var(--border)}.label{font-size:0.6rem;font-weight:700;text-transform:uppercase;letter-spacing:2px;opacity:0.4;margin-bottom:12px;display:block;text-align:left}.btn-row{display:flex;gap:8px;flex-wrap:wrap;justify-content:center}.btn-opt{padding:10px;border:1px solid var(--border);background:var(--card);border-radius:14px;cursor:pointer;font-size:0.7rem;color:var(--text);flex:1 1 auto;transition:0.2s}.btn-opt.active{background:var(--text);color:var(--card)}.panel{display:none;padding-top:20px}.shape-item{aspect-ratio:1;border:1px solid var(--border);border-radius:12px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:1.2rem;background:var(--card);transition:0.2s}.shape-item.active{background:var(--text);color:var(--card);border-color:var(--text)}.shape-gallery{display:none;grid-template-columns:repeat(6,1fr);gap:8px;margin-bottom:20px;background:var(--bg);padding:15px;border-radius:20px;border:1px solid var(--border);max-height:200px;overflow-y:auto}.custom-emoji-box{display:flex;gap:8px;margin-bottom:20px}.custom-input{flex:1;padding:12px;border-radius:12px;border:1px solid var(--border);background:var(--card);color:var(--text);font-size:1rem;text-align:center}.custom-btn{padding:0 20px;border:none;border-radius:12px;background:var(--text);color:var(--card);cursor:pointer;font-size:0.8rem;font-weight:600}.pastel-bar{display:flex;gap:6px;flex-wrap:wrap}.brush-btn{background:none;border:1px solid var(--border);border-radius:8px;padding:6px 12px;cursor:pointer;font-size:0.75rem;color:var(--text);opacity:0.6;display:flex;align-items:center;gap:4px}.color-gallery{display:none;flex-direction:column;gap:12px;max-height:220px;overflow-y:auto;padding:15px;background:var(--bg);border-radius:20px;border:1px solid var(--border);margin-top:10px}.color-group{display:flex;gap:8px;align-items:center;margin-bottom:4px}.color-dot{width:22px;height:22px;border-radius:50%;cursor:pointer;border:2px solid transparent;flex-shrink:0;transition:0.2s}.color-dot.selected{border-color:var(--text);transform:scale(1.2)}.board{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;margin:2rem 0;position:relative}.cell{aspect-ratio:1;background:var(--cell);border-radius:24px;display:flex;align-items:center;justify-content:center;font-size:2.8rem;cursor:pointer;border:1px solid var(--border)}.cell.win{background:var(--text)!important;color:var(--card)!important;animation:winPulse 1.2s ease-in-out infinite;border:none}@keyframes winPulse{0%,100%{transform:scale(0.95)}50%{transform:scale(1.02)}}.main-btn{width:100%;padding:20px;border:none;border-radius:25px;background:var(--text);color:var(--card);font-weight:700;cursor:pointer;letter-spacing:2px}.share-url{font-size:0.65rem;background:var(--bg);padding:12px;border-radius:15px;margin-top:10px;display:none;border:1px dashed var(--border);flex-direction:column;gap:10px;align-items:center}.copy-btn{background:var(--text);color:var(--card);border:none;padding:8px 15px;border-radius:10px;font-size:0.6rem;font-weight:700;cursor:pointer}.theme-ico,.lang-ico{position:absolute;top:25px;cursor:pointer;opacity:0.5;z-index:100}.theme-ico{right:25px}.lang-ico{right:65px;font-size:0.8rem;font-weight:700;background:var(--cell);padding:4px 8px;border-radius:8px;border:1px solid var(--border)}.expand-btn{width:100%;padding:12px;margin-top:10px;background:var(--card);border:1px solid var(--border);border-radius:15px;cursor:pointer;font-size:0.7rem;color:#999}footer{position:fixed;bottom:20px;left:0;right:0;text-align:center;font-size:0.65rem;opacity:0.4;letter-spacing:1px;text-transform:uppercase}
</style></head><body>
<div class="container" id="menu">
    <div class="lang-ico" onclick="toggleL()" id="lang-btn">ES</div><div class="theme-ico" onclick="toggleT()">üåì</div><h2 id="t-title">Tres en Raya</h2>
    <div class="block"><span class="label" id="t-mode">Modo</span><div class="btn-row"><button class="btn-opt" id="mIA" onclick="cfg('m','IA')">IA</button><button class="btn-opt" id="mAM" onclick="cfg('m','AM')">AMIGOS</button><button class="btn-opt" id="mON" onclick="createOnline()">ONLINE</button></div><div id="share-box" class="share-url"></div></div>
    <div class="block" id="ia-config"><span class="label" id="t-ia-dif">Dificultad IA</span><div class="btn-row"><button class="btn-opt" id="dif0" onclick="cfg('d','0')">Beb√©</button><button class="btn-opt" id="dif1" onclick="cfg('d','1')">F√°cil</button><button class="btn-opt" id="dif2" onclick="cfg('d','2')">Normal</button><button class="btn-opt" id="dif3" onclick="cfg('d','3')">Dif√≠cil</button><button class="btn-opt" id="dif5" onclick="cfg('d','5')">Imposible</button></div></div>
    <div class="block"><span class="label" id="t-style">Estilo de Juego</span><button class="expand-btn" onclick="toggleP('p1')" id="t-cust-btn">Personalizar Fichas +</button><div id="p1" class="panel"><div class="btn-row" style="margin-bottom:20px" id="p-selector"><button class="btn-opt active" id="selP1" onclick="selPlayer(1)">JUGADOR 1</button><button class="btn-opt" id="selP2" onclick="selPlayer(2)">JUGADOR 2</button></div><span class="label" id="t-sym-label">S√≠mbolo</span><div class="btn-row" id="feat-sh"></div><button class="expand-btn" onclick="toggleFullShapes()">üîç Ver Galer√≠a Completa</button><div class="shape-gallery" id="sh-gal"></div><span class="label" id="t-cust-sym">Emoji Personalizado</span><div class="custom-emoji-box"><input type="text" id="cust-em" class="custom-input" placeholder="Emoji" maxlength="2"><button class="custom-btn" onclick="setCustomEM()">USAR</button></div><span class="label" id="t-col-label">Color</span><div class="pastel-bar" id="pastels"></div><button class="brush-btn" onclick="toggleFullPalette()">üé® M√°s Colores</button><div class="color-gallery" id="gal1"></div></div></div>
    <button class="main-btn" onclick="start()" id="t-start">INICIAR JUEGO</button><button class="expand-btn" onclick="window.open('https://janiito-studio.github.io/Janiito-Studio/','_blank')" style="border:none;margin-top:20px;opacity:0.6">M√ÅS JUEGOS</button>
</div>
<div class="container" id="game" style="display:none"><div id="status" style="margin-bottom:20px;letter-spacing:2px;font-size:0.8rem"></div><div class="board" id="board"><div class="cell" data-i="0"></div><div class="cell" data-i="1"></div><div class="cell" data-i="2"></div><div class="cell" data-i="3"></div><div class="cell" data-i="4"></div><div class="cell" data-i="5"></div><div class="cell" data-i="6"></div><div class="cell" data-i="7"></div><div class="cell" data-i="8"></div></div><button class="main-btn" onclick="reset()">REPETIR</button><button class="expand-btn" onclick="location.href=location.pathname" style="border:none">MEN√ö</button></div>
<script>
const firebaseConfig={apiKey:"AIzaSyAhw0XkApKqckG4hqfkEm6Zkyfz4wG4-K0",authDomain:"en-raya-71ad8.firebaseapp.com",databaseURL:"https://en-raya-71ad8-default-rtdb.firebaseio.com",projectId:"en-raya-71ad8",storageBucket:"en-raya-71ad8.firebasestorage.app",messagingSenderId:"680061995774",appId:"1:680061995774:web:286c0f3ef9b563dd23b3af"};firebase.initializeApp(firebaseConfig);const db=firebase.database();const translations={ca:{title:'Tres en Ratlla',mode:'Mode',ia:'IA',friends:'AMICS',online:'ONLINE',ia_dif:'Dificultat',style:'Estil',p1:'P1',p2:'P2',ai_p2:'IA',start:'JUGAR',victory:'VICT√íRIA!',draw:'EMPAT',ai_won:'IA GUANYA'},es:{title:'Tres en Raya',mode:'Modo',ia:'IA',friends:'AMIGOS',online:'ONLINE',ia_dif:'Dificultad',style:'Estilo',p1:'P1',p2:'P2',ai_p2:'IA',start:'JUGAR',victory:'VICTORIA!',draw:'EMPATE',ai_won:'IA GANA'},en:{title:'Tic Tac Toe',mode:'Mode',ia:'AI',friends:'FRIENDS',online:'ONLINE',ia_dif:'Difficulty',style:'Style',p1:'P1',p2:'P2',ai_p2:'AI',start:'START',victory:'VICTORY!',draw:'DRAW',ai_won:'AI WON'}};const colorStudio=[{name:'Soft',colors:['#FFB7B2','#FFDAC1','#E2F0CB','#B5EAD7','#C7CEEA','#F3D1F4','#FFEEAD']},{name:'Basic',colors:['#dc2626','#2563eb','#059669','#7c3aed','#db2777']}];const defaultPastels=['#FFB7B2','#FFDAC1','#E2F0CB','#B5EAD7','#C7CEEA','#F3D1F4','#93c5fd'];const aestheticShapes=['‚úï','‚óØ','‚ñ≤','‚ú¶','‚òÖ','‚ô•','‚óÜ','‚ô†','‚ô£','‚ô¶','‚ö°','‚úø'];const featuredShapes=['‚úï','‚óØ','‚ñ≤','‚ú¶','‚òÖ','‚ô•'];let s=JSON.parse(localStorage.getItem('ttt_v2'))||{m:'IA',d:'5',th:'light',l:'es',p1:{t:'‚ú¶',c:'#ef4444'},p2:{t:'‚óØ',c:'#3b82f6'}};let editingPlayer=1,grid=Array(9).fill(""),live=false,turn="P1",myRole="P1",salaID=new URLSearchParams(window.location.search).get('sala');function cfg(k,v){if(['m','d','th','l'].includes(k))s[k]=v;else(editingPlayer===1?s.p1:s.p2)[k]=v;localStorage.setItem('ttt_v2',JSON.stringify(s));sync()}function toggleL(){const l=['ca','es','en'];cfg('l',l[(l.indexOf(s.l)+1)%l.length])}function t(k){return translations[s.l][k]||k}function selPlayer(n){editingPlayer=n;sync()}function toggleT(){cfg('th',s.th==='dark'?'light':'dark')}function toggleP(id){const e=document.getElementById(id);e.style.display=e.style.display==='block'?'none':'block'}function sync(){document.body.dataset.theme=s.th;document.getElementById('lang-btn').innerText=s.l.toUpperCase();document.getElementById('t-title').innerText=t('title');document.getElementById('mIA').classList.toggle('active',s.m==='IA');document.getElementById('mAM').classList.toggle('active',s.m==='AM');document.getElementById('mON').classList.toggle('active',s.m==='ON');document.getElementById('ia-config').style.display=s.m==='IA'?'block':'none';document.getElementById('p-selector').style.display=s.m==='ON'?'none':'flex';document.getElementById('selP1').classList.toggle('active',editingPlayer===1);document.getElementById('selP2').classList.toggle('active',editingPlayer===2);renderS();renderPastels();renderG()}function toggleFullShapes(){toggleP('sh-gal')}function toggleFullPalette(){toggleP('gal1')}function renderPastels(){const e=document.getElementById('pastels');e.innerHTML='';const p=editingPlayer===1?s.p1:s.p2;defaultPastels.forEach(c=>{const d=document.createElement('div');d.className=`color-dot ${p.c===c?'selected':''}`;d.style.background=c;d.onclick=()=>cfg('c',c);e.appendChild(d)})}function setCustomEM(){const v=document.getElementById('cust-em').value.trim();if(v)cfg('t',v)}function createOnline(){const id=Math.random().toString(36).substring(7);const url=window.location.origin+window.location.pathname+'?sala='+id;document.getElementById('share-box').style.display='flex';document.getElementById('share-box').innerHTML=`<span style="font-size:10px">Link: ${url}</span><button class="copy-btn" onclick="navigator.clipboard.writeText('${url}')">COPIAR</button>`;salaID=id;cfg('m','ON')}function renderS(){const p=editingPlayer===1?s.p1:s.p2;const f=document.getElementById('feat-sh');f.innerHTML='';featuredShapes.forEach(x=>{const d=document.createElement('div');d.className=`shape-item ${p.t===x?'active':''}`;d.innerText=x;d.style.width='40px';d.onclick=()=>cfg('t',x);f.appendChild(d)});const g=document.getElementById('sh-gal');g.innerHTML='';aestheticShapes.forEach(x=>{const d=document.createElement('div');d.className=`shape-item ${p.t===x?'active':''}`;d.innerText=x;d.onclick=()=>cfg('t',x);g.appendChild(d)})}function renderG(){const p=editingPlayer===1?s.p1:s.p2,e=document.getElementById('gal1');e.innerHTML='';colorStudio.forEach(g=>{const div=document.createElement('div');div.className='color-group';g.colors.forEach(c=>{const d=document.createElement('div');d.className=`color-dot ${p.c===c?'selected':''}`;d.style.background=c;d.onclick=()=>cfg('c',c);div.appendChild(d)});e.appendChild(div)})}function start(){document.getElementById('menu').style.display='none';document.getElementById('game').style.display='block';live=true;grid=Array(9).fill("");turn="P1";if(salaID)conectar();else renderLocal()}function conectar(){const r=db.ref('salas/'+salaID);r.once('value',n=>{if(!n.exists()){myRole="P1";r.set({tablero:Array(9).fill(""),turno:"P1",p1:s})}else{myRole="P2";r.update({p2:s})}});r.on('value',n=>{const d=n.val();if(!d)return;grid=d.tablero;turn=d.turno;document.querySelectorAll('.cell').forEach((c,i)=>{c.innerText="";c.className="cell";if(grid[i]==="P1"){c.innerText=d.p1.p1.t;c.style.color=d.p1.p1.c}else if(grid[i]==="P2"){c.innerText=d.p2?d.p2.p2.t:"‚è≥";c.style.color=d.p2?d.p2.p2.c:"#ccc"}});const w=checkWin(grid);if(w){document.getElementById('status').innerText=t('victory');live=false;w.forEach(x=>document.querySelectorAll('.cell')[x].classList.add('win'))}})}function renderLocal(){document.querySelectorAll('.cell').forEach((c,i)=>{c.className="cell";c.innerText=grid[i]==="P1"?s.p1.t:(grid[i]==="P2"?s.p2.t:"");c.style.color=grid[i]==="P1"?s.p1.c:(grid[i]==="P2"?s.p2.c:"")});document.getElementById('status').innerText=t('turn')+": "+(turn==="P1"?s.p1.t:s.p2.t)}document.querySelectorAll('.cell').forEach(c=>{c.onclick=()=>{if(!live||grid[c.dataset.i]!=="")return;if(salaID){if(turn!==myRole)return;grid[c.dataset.i]=myRole;db.ref('salas/'+salaID).update({tablero:grid,turno:myRole==="P1"?"P2":"P1"})}else{grid[c.dataset.i]=turn;const w=checkWin(grid);if(w){renderLocal();document.getElementById('status').innerText=t('victory');live=false;w.forEach(x=>document.querySelectorAll('.cell')[x].classList.add('win'))}else if(grid.every(x=>x!=="")){document.getElementById('status').innerText=t('draw');live=false}else{turn=turn==="P1"?"P2":"P1";if(s.m==='IA'&&turn==='P2')setTimeout(ia,400);else renderLocal()}}}});function ia(){let a=grid.map((v,i)=>v===""?i:null).filter(v=>v!==null);if(a.length>0){grid[a[Math.floor(Math.random()*a.length)]]="P2";if(checkWin(grid)){renderLocal();document.getElementById('status').innerText=t('ai_won');live=false}else if(grid.every(x=>x!=="")){document.getElementById('status').innerText=t('draw');live=false}else{turn="P1";renderLocal()}}}function checkWin(b){const c=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];return c.find(x=>b[x[0]]&&b[x[0]]===b[x[1]]&&b[x[0]]===b[x[2]])}function reset(){if(salaID)db.ref('salas/'+salaID).update({tablero:Array(9).fill(""),turno:"P1"});else{grid=Array(9).fill("");live=true;turn="P1";renderLocal()}}sync();if(salaID){cfg('m','ON')}
</script><footer>Creado por janiito</footer></body></html>

